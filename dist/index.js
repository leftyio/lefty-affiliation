!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Lefty=t():e.Lefty=t()}(self,(()=>(()=>{"use strict";var e,t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.r(r),t.d(r,{check:()=>p,conversion:()=>s,conversionSingleProduct:()=>y,createOrder:()=>c,createProduct:()=>f,createProductItem:()=>l,pixel:()=>m,pixelSingleProduct:()=>v});var i="https://a.lefty.io";function u(e,t,r){var n=new XMLHttpRequest;n.open(e,i+t,!0),n.setRequestHeader("Content-type","application/json"),n.withCredentials=!0;var o=new Promise((function(e,t){n.onreadystatechange=function(){4===this.readyState&&(200===this.status?e(n.responseText):t(new Error(n.statusText)))}}));return r?n.send(JSON.stringify(r)):n.send(),o}function a(e){return e.map((function(e){return e.totalAmount})).reduce((function(e,t){return e+t}),0)}function c(e,t,r){return{externalOrderId:e,items:t,amount:r||a(t)}}function d(e,t){return c(e,[t],t.totalAmount)}function f(e,t){return{externalProductId:e,name:t}}function l(e,t,r,n){return{externalOrderItemId:e,product:t,totalAmount:r,quantity:n}}function p(e){return u("POST","/check?ref="+(e=e||window.location.hostname))}function s(t,r){r=r||{},t.pixelId=t.pixelId||e,t.currencyCode=t.currencyCode||r.currencyCode,t.referringDomain=r.referer||window.location.hostname;var n="/track/conversion";return r.debug?u("POST",n,t):p(r.referer).then(function(e){if(!0===(e=JSON.parse(e)).matchable)return u("POST",n,t)}.bind(this))}function y(e,t,r){return s(d(e,t),r)}function m(t,r){r=r||{};var n=t.items||[],o=t.externalOrderId,u=t.amount,a=t.pixelId||e,c=t.currencyCode||r.currencyCode,d=r.referer||window.location.hostname,f=i+"/track?type=conversion";if(f+="&orderId="+o,f+="&ref="+d,u&&(f+="&amount="+u),c&&(f+="&currency="+c),a&&(f+="&pixelId="+a),0!==n.length){var l=n.map((function(e){return"pId="+e.product.externalProductId})).join("&"),p=n.map((function(e){return"pName="+encodeURIComponent(e.product.name)})).join("&"),s=n.map((function(e){return"itemQty="+e.quantity})).join("&"),y=n.map((function(e){return"itemAmount="+e.totalAmount})).join("&"),m=n.map((function(e){return"itemId="+e.externalOrderItemId})).join("&");f+="&"+l,f+="&"+p,f+="&"+s,f+="&"+y,m&&(f+="&"+m)}(new Image).src=f}function v(e,t,r){return m(d(e,t),r)}function h(t){e=t;for(var r=window._lefty||[];r.length;){var o=r.shift();b.apply(void 0,n(o))}}function b(){var e=Array.prototype.slice.call(arguments);switch(e.shift()){case"check":return p.apply(void 0,n(e));case"pixel":return m.apply(void 0,n(e));case"conversion":return s.apply(void 0,n(e));case"init":return h.apply(void 0,n(e))}}return window.lefty=b,r})()));